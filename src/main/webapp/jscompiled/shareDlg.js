var shareDlgQuestionID="",shareDlgRelativePath="";
function shareDlg_initialize(a){if(a!=null)shareDlgRelativePath=a;$("#dlgShare").hide();$("#dlgShare_closeBtn").click(function(b){b.preventDefault();$("#dlgShare").hide()});$("#dlgShareEmail_sendBtn").click(function(b){b.preventDefault();if(common_checkPOST()){$("#dlgShareEmail_waitingIcon").show();b=$("#dlgShareEmail_txt").val();if(common_checkEmail(b))$.ajax({url:shareDlgRelativePath+"api/questions/share/"+b+"/"+shareDlgQuestionID,type:"GET",success:function(){$("#dlgShareEmail_waitingIcon").hide();$("#dlgShareEmail_txt").val("");
$("#dlgShare").hide()},error:function(c){notifyBar_display(ERR_MSG_QUESTION_CANT_SENDED+":"+c.status,ICON_URL_NOTIFY_WRONG);$("#dlgShareEmail_waitingIcon").hide()}});else{$("#dlgShareEmail_waitingIcon").hide();notifyBar_display(ERR_MSG_EMAIL_INVALID_FORMAT,ICON_URL_NOTIFY_WRONG)}}return false})}
function shareDlg_display(a,b,c){a=a.position();$("#dlgShare").css("position","absolute");$("#dlgShare").css("left",a.left+b);$("#dlgShare").css("top",a.top+c);$("#dlgShareEmail").hide();$("#dlgShareEmail_txt").val("");$("#dlgShareEmail_succeedLabel").hide();$("#dlgShareEmail_waitingIcon").hide();$("#dlgShare").show()}var facebookShareURL="",twitterShareURL="";
function shareDlg_setContent(a){var b=shareDlgQuestionID=a.id;a=a.body;var c="";c=a.length>93?a.substr(0,93)+"...? ":a+" ";getBitlyURL("http://trendocean.com/question/"+b,function(d){facebookShareURL="http://www.facebook.com/sharer.php?u="+d;twitterShareURL="http://twitter.com/intent/tweet?status="+c+d+" via @trendocean";$("#dlgShare_facebookBtn").attr("href",facebookShareURL);$("#dlgShare_twitterBtn").attr("href",twitterShareURL);$("#dlgShare_facebookBtn").click(function(){$("#dlgShare").hide()});
$("#dlgShare_twitterBtn").click(function(){$("#dlgShare").hide()});$("#dlgShare_emailBtn").click(function(e){e.preventDefault();$("#dlgShareEmail").show()})})}function getTinyURL(a,b){var c="http://json-tinyurl.appspot.com/?url="+encodeURIComponent(a)+"&callback=?";$.getJSON(c,function(d){b&&b(d.tinyurl)})}function getBitlyURL(a,b){(new $.Bitly({login:"trendocean",key:"R_053c164d6d7148a5a82dd5fa56969b25"})).shorten(a,{onSuccess:function(c){b&&b(c)},onError:function(){}})};
