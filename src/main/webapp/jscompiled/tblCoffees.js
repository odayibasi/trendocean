var coffee_directive={"@id":'"message"',"div.coffee_part":{"post <- message":{"div.coffee_id":"post.id","a.cAvatarImgLink@href":"post.sender","img.cAvatarImg@src":"post.smallAvatarURL","a.cOwner":"post.sender","a.cOwner@href":"post.sender","div.statuscoffe_read":function(a){return common_contentProcess(a.item.messageText)},"a.coffeecup_replybutton@style":function(a){return a.item.canReplyByRequester=="true"?"":"display:none"},"a.coffeecup_deletebutton@style":function(a){return a.item.isRemovableByRequester==
"true"?"":"display:none"},"span.coffeecup_qCreationDate":function(a){return common_getRemainingTime(new Date(a.item.creationDate*1))}}}},coffee_template,display_coffees=null,selected_coffee=null,tblCoffees_data=null;
function tblCoffees_initialize(){$("#btnMore").hide();$(".coffee_def").hide();coffee_template=$("#coff_part").compile(coffee_directive);$("#coff_part").hide();$("#tableLoadingIcon").hide();$(".coffeecup_replybutton").live("click",function(a){a.preventDefault();var b=$(this).parents(".coffee_part").children(":first-child").children(":first-child").text();selected_coffee=tblCoffees_getCoffee(b);if(selected_coffee!=null){a.preventDefault();a=$(this).position();coffeeDlg_setContent(selected_coffee.sender,
cookie_get(COOKIE_USERNAME),selected_coffee.smallAvatarURL);coffeeDlg_show(a)}});$(".coffeecup_deletebutton").live("click",function(a){a.preventDefault();var b=$(this).parents(".coffee_part").children(":first-child").children(":first-child").text();selected_coffee=tblCoffees_getCoffee(b);selected_coffee!=null&&$.ajax({url:"api/messages/remove/"+b,type:"POST",success:function(){tblCoffees_removeCoffee(b)},error:function(c){notifyBar_display(ERR_MSG_WEBSERVICE+":"+c.status,ICON_URL_NOTIFY_WRONG)}});
return false})}function tblCoffees_getCoffee(a){for(i=0;i<display_coffees.length;i++){var b=display_coffees[i];if(b.id==a)return b}return null}function tblCoffees_addCoffee(a){if(tblCoffees_data==null)tblCoffees_data={};var b=[];b[0]=a;if(display_coffees!=null)tblCoffees_data.message=b.concat(display_coffees);else tblCoffees_data.messaget=a;tblCoffees_renderCoffees(tblCoffees_data)}
function tblCoffees_removeCoffee(a){for(i=0;i<display_coffees.length;i++)if(display_coffees[i].id==a)break;display_coffees.splice(i,1);tblCoffees_renderCoffees(tblCoffees_data)}
function tblCoffees_renderCoffees(a){var b=$(window).scrollTop();$("#static_que_section").html("<div id=que_section></div>");tblCoffees_data=a;if(a==null){a={};display_coffees=null}else display_coffees=$.isArray(a.message)?a.message:Array(a.message);a.message=display_coffees;$("#que_section").render(a,coffee_template);$(window).scrollTop(b);$(".coffeecup_deletebutton").attr("title","delete coffee")};
