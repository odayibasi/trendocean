var coffee_receiver=null,coffee_receiverAvatar="",coffee_relativePath="",coffee_sender=null,coffee_DlgHideTimeOut=-1,coffee_DlgPage="";
function coffeeDlg_sendMsg(){$("#dlgCoffee_loaderIcon").show();var a={};a.messageText=$("#dlgCoffee_msg").val();a.receiver=coffee_receiver;a.inReplyToID=coffee_sender;a=$.toJSON(a);$.ajax({url:coffee_relativePath+"api/messages/public/",type:"POST",data:a,dataType:"json",contentType:"application/json; charset=utf-8",success:function(){$("#dlgCoffee_loaderIcon").hide();$("#dlgCoffee_lblSucceed").show();$("#coffeeMsgTextCounter").hide();$("#dlgCoffee_msg").val("");coffee_DlgHideTimeOut=setTimeout("coffeeDlg_hideAfterSucceedMsg()",
COFFEE_DLG_HIDE_WAIT_TIME)},error:function(c){notifyBar_display(ERR_MSG_WEBSERVICE+":"+c.status,ICON_URL_NOTIFY_WRONG)}});return false}function coffeeDlg_hideAfterSucceedMsg(){$("#dlgCoffee").fadeOut("slow",function(){clearTimeout(coffee_DlgHideTimeOut)})}
function coffeeDlg_show(a){$("#dlgCoffee").css("position","absolute");$("#dlgCoffee").css("top",a.top);a=$(window).width();var c=$("#dlgCoffee").width();$("#dlgCoffee").css("left",(a-c)/2);$("#dlgCoffee_msg").val("");$("#dlgCoffee_lblSucceed").hide();$("#dlgCoffee_loaderIcon").hide();$("#dlgCoffee").show();$("#dlgCoffee_msg").focus();$("#coffeeMsgTextCounter").show()}
function coffeeDlg_initialize(a,c){if(c!=null)coffee_DlgPage=c;$("#dlgCoffee_lblSucceed").hide();$("#dlgCoffee_loaderIcon").hide();$("#dlgCoffee").hide();$("#dlgCoffee_msg").counter({dispID:"coffeeMsgTextCounter",goal:"120",dispIDColor:"#666"});a!=null&&a.click(function(b){b.preventDefault();b=$(this).position();coffeeDlg_show(b)});$("#dlgCoffee_sendBtn").click(function(b){b.preventDefault();common_checkPOST()&&coffeeDlg_sendMsg()});$("#dlgCoffee_closeBtn").click(function(b){b.preventDefault();$("#dlgCoffee").hide()})}
function coffeeDlg_setContent(a,c,b){coffee_receiver=a;coffee_receiverAvatar=b;coffee_sender=c;a="Send username a cup of coffee".replace("username",a);$("#dlgCoffee_info").text(a);$("#avatarOfCoffeeReceiver").attr("src",coffee_receiverAvatar);$("#avatarOfCoffeeReceiver").attr("title",coffee_receiver)}function coffeeDlg_setRelativePath(a){coffee_relativePath=a};
